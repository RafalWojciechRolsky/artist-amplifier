# Test Design: Story 3.1

Date: 2025-09-02
Designer: Quinn (Test Architect)

## Test Strategy Overview

- Total test scenarios: 9
- Unit tests: 5 (56%)
- Integration tests: 3 (33%)
- E2E tests: 1 (11%)
- Priority distribution: P0: 3, P1: 5, P2: 1

## Test Scenarios by Acceptance Criteria

### AC1: A new text input field labeled "Song Title" is added to the main form.

| ID            | Level | Priority | Test                                                              | Justification                                    |
| ------------- | ----- | -------- | ----------------------------------------------------------------- | ------------------------------------------------ |
| 3.1-UNIT-001  | Unit  | P1       | Verify the input field renders correctly with the label "Song Title". | Component testing ensures UI correctness.        |
| 3.1-UNIT-002  | Unit  | P2       | Verify the input field is of type "text".                         | Basic HTML attribute validation.                 |

### AC2: The "Song Title" field is required.

| ID            | Level | Priority | Test                                                                 | Justification                                       |
| ------------- | ----- | -------- | -------------------------------------------------------------------- | --------------------------------------------------- |
| 3.1-UNIT-003  | Unit  | P1       | Verify form submission fails if the "Song Title" is empty.           | Core validation logic for the component.            |
| 3.1-UNIT-004  | Unit  | P1       | Verify a validation message is shown when submitting with an empty title. | Ensures proper user feedback on validation failure. |
| 3.1-UNIT-005  | Unit  | P1       | Verify form submission succeeds if the "Song Title" is provided.     | Validates the positive case for the validation logic. |

### AC3: The entered song title is sent to the backend.

| ID            | Level       | Priority | Test                                                                 | Justification                                                          |
| ------------- | ----------- | -------- | -------------------------------------------------------------------- | ---------------------------------------------------------------------- |
| 3.1-INT-001   | Integration | P0       | Verify the API call to `/api/audio/generate` includes the `songTitle`. | Critical data flow between frontend and backend. Mitigates `SEC-001`. |

### AC4: The backend associates the song title with the analysis job.

| ID            | Level       | Priority | Test                                                                    | Justification                                    |
| ------------- | ----------- | -------- | ----------------------------------------------------------------------- | ------------------------------------------------ |
| 3.1-INT-002   | Integration | P0       | Verify the backend handler correctly receives and parses the `songTitle`. | Ensures the backend is processing the data correctly. |

### AC5: The song title is used in the prompt for generating the final description.

| ID            | Level | Priority | Test                                                                    | Justification                                                     |
| ------------- | ----- | -------- | ----------------------------------------------------------------------- | ----------------------------------------------------------------- |
| 3.1-UNIT-006  | Unit  | P1       | Verify the prompt generation function includes the `songTitle`.         | Core business logic for the feature.                              |
| 3.1-E2E-001   | E2E   | P1       | Verify the end-to-end flow results in a description reflecting the title. | Validates the complete user journey for this story.               |

## Risk Coverage

| Risk ID | Mitigating Test Scenario(s) |
| ------- | --------------------------- |
| SEC-001 | 3.1-INT-001, 3.1-INT-003    |

*(A new integration test `3.1-INT-003` is implicitly defined here to cover security aspects)*

## Recommended Execution Order

1.  **P0 Tests**: `3.1-INT-001`, `3.1-INT-002`
2.  **P1 Tests**: `3.1-UNIT-001`, `3.1-UNIT-003`, `3.1-UNIT-004`, `3.1-UNIT-005`, `3.1-UNIT-006`, `3.1-E2E-001`
3.  **P2 Tests**: `3.1-UNIT-002`
