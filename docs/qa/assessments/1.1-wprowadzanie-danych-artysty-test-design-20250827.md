<!-- Powered by BMAD™ Core -->

# Test Design: Story 1.1 – Wprowadzanie Danych Artysty

- Data: 2025-08-27
- Story: [docs/stories/1.1.wprowadzanie-danych-artysty.md](../stories/1.1.wprowadzanie-danych-artysty.md)
- Zakres: Formularz z polami „Nazwa artysty/zespołu” (required) i „Opis artysty” (required, textarea 50–1000, licznik), walidacje, a11y, mobile, persistencja w `sessionStorage` (`aa:v1:*`).

## Cele testów

- Zweryfikować zgodność z AC (1–7).
- Zredukować ryzyka z profilu ryzyka (a11y, mobile, UX walidacji, persistencja).
- Zapewnić testowalność walidatorów i zachowań UI.

## Mapowanie wymagań → testy

- Required fields: TC1.1, TC1.2
- Limity znaków i licznik: TC1.3, TC1.4, TC1.5
- sessionStorage: TC3.1, TC3.2, TC3.3
- UX walidacji: TC2.1, TC2.2, TC2.3
- A11y: TC4.1, TC4.2, TC4.3
- Responsive: TC5.1, TC5.2, TC5.3
- Znaki specjalne/emoji: TC6.1, TC6.2
- Integracja/stany: TC7.1, TC7.2
- Wydajność UI: TC8.1

## Scenariusze (Given–When–Then)

### 1. Walidacje

- TC1.1 Wymagane pola (H, Unit/Functional)
  Given strona formularza
  When submit bez danych
  Then błędy dla obu pól i brak submitu

- TC1.2 Nazwa uzupełniona, opis pusty (H)
  Given strona formularza
  When nazwa wypełniona, opis pusty, submit
  Then błąd tylko dla opisu, brak submitu

- TC1.3 Min. długość opisu 50 (H)
  Given strona formularza
  When opis = 49 znaków, submit
  Then błąd o minimum 50, brak submitu

- TC1.4 Max. długość opisu 1000 (H)
  Given strona formularza
  When użytkownik wpisuje 1001 znaków
  Then pole ogranicza do 1000 lub pojawia się błąd „max 1000”

- TC1.5 Licznik znaków (M)
  Given strona formularza
  When użytkownik wpisuje tekst w opisie
  Then licznik aktualizuje się w czasie rzeczywistym i jest poprawny

### 2. UX walidacji

- TC2.1 Timing walidacji (M)
  Given strona formularza
  When blur z pustym polem
  Then błąd pojawia się po blur, nie w trakcie pisania

- TC2.2 Czytelność komunikatów (H)
  Given wystąpiły błędy
  Then komunikaty po polsku, zrozumiałe, przypisane do pól

- TC2.3 Sukces submitu (H, Integracja)
  Given poprawne dane w obu polach
  When submit
  Then dane zapisane, aplikacja przechodzi do kolejnego kroku bez błędów

### 3. Persistencja (sessionStorage)

- TC3.1 Zapis (H)
  Given poprawne dane
  Then zapis do `sessionStorage` z kluczami `aa:v1:*`

- TC3.2 Odtworzenie po odświeżeniu (H)
  Given dane wcześniej zapisane
  When refresh
  Then formularz wstępnie wypełniony poprzednimi wartościami

- TC3.3 Brak dostępu do storage (M, Edge)
  Given storage niedostępny (tryb prywatny/ograniczenia)
  Then brak crasha, łagodna degradacja UX

### 4. Dostępność (A11y)

- TC4.1 Nawigacja klawiaturą (H)
  Given formularz
  When Tab/Shift+Tab
  Then logiczna kolejność fokusu, wyraźne wskaźniki focus

- TC4.2 Czytniki ekranu (H)
  Given użytkownik z czytnikiem
  Then elementy poprawnie anonsowane; błędy przez aria-live

- TC4.3 Atrybuty ARIA (H)
  Then pola mają label, required, aria-invalid przy błędach, aria-describedby dla komunikatów

### 5. Responsive

- TC5.1 Mobile 320px (H)
  Then brak poziomego scrolla, licznik widoczny/czytelny

- TC5.2 Tablet (M)
  Then układ i spacing poprawne

- TC5.3 Desktop (M)
  Then czytelność i wykorzystanie przestrzeni

### 6. Znaki specjalne

- TC6.1 Diakrytyki/polskie znaki (M)
  Then poprawna obsługa i liczenie znaków

- TC6.2 Emoji (L)
  Then poprawna obsługa i liczenie znaków

### 7. Integracja

- TC7.1 Przekazanie stanu do `page.tsx` (H)
  Then komponent nadrzędny otrzymuje i przetwarza dane

- TC7.2 Przejścia stanów (H)
  Then submit zmienia stan z `idle` → `generating` (zgodnie z architekturą)

### 8. Wydajność UI

- TC8.1 Responsywność licznika (M)
  Then szybkie aktualizacje licznika przy szybkim wpisywaniu, brak laga UI

## Matryca pokrycia

| Obszar            | Testy               |
| ----------------- | ------------------- |
| Required fields   | TC1.1, TC1.2        |
| Limity/LICZNIK    | TC1.3, TC1.4, TC1.5 |
| sessionStorage    | TC3.1, TC3.2, TC3.3 |
| UX walidacji      | TC2.1, TC2.2, TC2.3 |
| A11y              | TC4.1, TC4.2, TC4.3 |
| Responsive        | TC5.1, TC5.2, TC5.3 |
| Znaki spec./emoji | TC6.1, TC6.2        |
| Integracja        | TC7.1, TC7.2        |
| Wydajność         | TC8.1               |

## Artefakty do dostarczenia

- Jednostkowe: walidatory, licznik, (mock) sessionStorage.
- A11y: raport z `axe` + checklista ręczna.
- UI: zrzuty ekranu dla 320–480 px.
- Integracja: testy z React Testing Library (happy path + błędy).

## Uwagi wykonawcze

- Testy jednostkowe w `__tests__` obok komponentów; framework: Jest.
- Mockowanie `sessionStorage`; feature detection + try/catch.
- Teksty komunikatów w jednym miejscu (PL).
- Tailwind mobile-first; weryfikacja minimalnej szerokości i overflow.

## Decyzja QA (dla test-designu)

- Kompletny plan pokrywa AC i główne ryzyka; priorytet: testy High najpierw.

## Wykonanie – Notatki (2025-08-27 21:31)

### Podsumowanie uruchomienia
- Polecenie: `npm test`
- Wynik: 2/2 suites PASS, 6/6 tests PASS (Jest + jsdom)

### Pokrycie względem TCs
- Required fields: TC1.1/TC1.2 – PARTIAL (walidacja po blur; brak ścieżki submitu)
- Limity/licznik: TC1.3, TC1.4, TC1.5 – PASS (min/max + licznik live)
- UX walidacji: TC2.1 – PASS (timing po blur); TC2.2–TC2.3 – GAP
- sessionStorage: TC3.1 – PASS (set/get); TC3.2 – GAP (odtworzenie po refresh); TC3.3 – GAP (brak storage)
- A11y: TC4.1 – PARTIAL (Tab/blur incydentalnie); TC4.2–TC4.3 – GAP
- Responsive: TC5.1–TC5.3 – GAP
- Znaki spec./emoji: TC6.1–TC6.2 – GAP
- Integracja: TC7.1–TC7.2 – GAP
- Wydajność: TC8.1 – GAP

### Następne kroki (proponowana kolejność)
1) High: TC3.2 (odtworzenie po refresh), TC2.2 (czytelność komunikatów), TC4.1 pełna sekwencja focus, TC1.1/TC1.2 warianty z próbą submitu.
2) High: TC5.1 (mobile 320px) – weryfikacja overflow/scroll, screenshoty.
3) High: TC3.3 (brak storage) – mock `sessionStorage` z rzucaniem wyjątku.
4) Medium: TC4.3 (ARIA atrybuty) i TC1.x skrajne wartości (50/1000 dokładnie).
5) Medium: TC7.1–TC7.2 (integracja z `page.tsx` i stanami maszyny), TC8.1 (responsywność licznika pod obciążeniem).
